var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};!function(pe){var Ee={ACTIVE:"active",LOADER_SHOW:"show-loader",CONTAINER:"cp-container",CALENDAR:"cp-calendar",MONTH_CALENDAR:"cp-calendar-{month}",SEASON_CALENDAR:"cp-calendar-{season}",HEADER:"cp-header",HEADER_CONTENT:"cp-header-content",HEADER_OPTIONS_CONTAINER:"cp-header-options-container",HEADER_OPTIONS:"cp-header-options",HEADER_OPTIONS_INNER:"cp-header-options-inner",HEADER_OPTIONS_BUTTONS_CONTAINER:"cp-header-options-buttons-container",HEADER_OPTIONS_BUTTON:"cp-header-options-button",HEADER_OPTIONS_ABOVE:"cp-header-options-above",HEADER_OPTIONS_VISIBLE:"cp-header-options-visible",NAV_CONTROLS:"cp-nav-controls",CONTROLS_CONTAINER:"cp-nav",MONTH_HEADER:"cp-header-{month}",SEASON_HEADER:"cp-header-{season}",DATE_CELL:"cp-date",DATE_DAY:"cp-day",DATE_SELECTED:"cp-date-selected",DATE_CELL_CONTENT:"cp-date-content",WEEK_ROW:"cp-week",WEEK_EVENTS:"cp-week-events",MONTH_HEADING:"cp-month-heading",MONTH_CELL:"cp-month",MONTH_NAME_BUTTON:"cp-month-name",EMPTY_DAY:"cp-empty-day",EMPTY_DAY_BEGINNING:"cp-empty-day-beginning",EMPTY_DAY_ENDING:"cp-empty-day-ending",ADD_MENU_CONTAINER:"cp-add-menu",ADD_MENU_INNER:"cp-add-menu-inner",ADD_MENU_BUTTONS_CONTAINER:"cp-add-menu-buttons-container",ADD_MENU_BUTTON:"cp-add-menu-button",ADD_MENU_ABOVE:"cp-add-menu-above",ADD_MENU_VISIBLE:"cp-add-menu-visible",EVENT_MENU_CONTAINER:"cp-event-menu",EVENT_MENU_INNER:"cp-event-menu-inner",EVENT_MENU_BUTTONS_CONTAINER:"cp-event-menu-buttons-container",EVENT_MENU_BUTTON:"cp-event-menu-button",EVENT_MENU_ABOVE:"cp-event-menu-above",EVENT_MENU_VISIBLE:"cp-event-menu-visible",VIEWS_LIST_CONTAINER:"cp-view-list-container",VIEWS_LIST:"cp-view-list",VIEWS_ITEM:"cp-view",VIEW_BUTTON:"cp-view-button",SHOW_COPIED_EVENT_MENU:"cp-show-copied-menu"},ve={BODY:"body",CONTAINER:".cp-container",CONTAINER_ID:"cp-container-id",CALENDAR:".cp-calendar",HEADER:".cp-header",HEADER_CONTENT:".cp-header-content",HEADER_OPTIONS_CONTAINER:".cp-header-options-container",HEADER_OPTIONS:".cp-header-options",HEADER_OPTIONS_INNER:".cp-header-options-inner",HEADER_OPTIONS_BUTTONS_CONTAINER:".cp-header-options-buttons-container",HEADER_OPTIONS_BUTTON:".cp-header-options-button",HEADER_OPTIONS_ABOVE:".cp-header-options-above",HEADER_OPTIONS_VISIBLE:".cp-header-options-visible",NAV_CONTROLS:".cp-nav-controls",CONTROL_BUTTONS:"button.cp-nav",DATE_CELL:".cp-date",DATE_DAY:".cp-day",DATE_SELECTED:".cp-date-selected",DATE_CELL_CONTENT:".cp-date-content",WEEK_ROW:".cp-week",WEEK_EVENTS:".cp-week-events",MONTH_HEADING:".cp-month-heading",MONTH_CELL:".cp-month",MONTH_NAME_BUTTON:".cp-month-name",EMPTY_DAY:".cp-empty-day",EMPTY_DAY_BEGINNING:".cp-empty-day-beginning",EMPTY_DAY_ENDING:".cp-empty-day-ending",ADD_MENU_CONTAINER:".cp-add-menu",ADD_MENU_INNER:".cp-add-menu-inner",ADD_MENU_BUTTON:".cp-add-menu-button",ADD_MENU_BUTTONS_CONTAINER:".cp-add-menu-buttons-container",EVENT_MENU_CONTAINER:".cp-event-menu",EVENT_MENU_INNER:".cp-event-menu-inner",EVENT_MENU_BUTTON:".cp-event-menu-button",EVENT_MENU_BUTTONS_CONTAINER:".cp-event-menu-buttons-container",VIEWS_LIST_CONTAINER:".cp-view-list-container",VIEWS_LIST:".cp-view-list",VIEWS_ITEM:".cp-view",VIEW_BUTTON:".cp-view-button",VIEW_SELECTOR:'[data-toggle="calendar-view"]',EVENT_FORM_MODAL:".cp-ef-modal",EXPORT_BUTTON:'[data-export="calendar"]'},me={CONTAINER:"<div class='"+Ee.CONTAINER+"' id='"+ve.CONTAINER_ID+"'>{header}{calendar}{add_menu}{event_menu}</div>",MAIN:"<table class='"+Ee.CALENDAR+" {classnames}'  cellspacing='0' cellpadding='0'><thead>{heading}</thead><tbody>{content}</tbody></table>",DAYS_HEADING:"<tr class='"+Ee.MONTH_HEADING+"'> <th>Sun</th> <th>Mon</th> <th>Tue</th> <th>Wed</th> <th>Thur</th> <th>Fri</th> <th>Sat</th> </tr>",WEEK_ROW:"<tr class='"+Ee.WEEK_ROW+"' data-row='{row}'>{content}</tr>",DAY_CELL:"<td class='"+Ee.DATE_CELL+" {classnames}' data-date='{date}'><div class='"+Ee.DATE_CELL_CONTENT+"'>{content}</div></td>",HEADER:("\n            <div class='"+Ee.HEADER+" {classnames}'>\n                <div class='"+Ee.NAV_CONTROLS+"'>\n                    {left-control}\n                    <button class='"+Ee.MONTH_NAME_BUTTON+"'>{month}<span class='caret'></span></button>\n                    {right-control}\n                </div>\n                <div class='"+Ee.HEADER_CONTENT+"'>\n                    <div class='"+Ee.HEADER_OPTIONS_CONTAINER+"'>\n                        <div class='"+Ee.HEADER_OPTIONS+"' id='headerOptionsComponent'>\n                            <div class='"+Ee.HEADER_OPTIONS_INNER+"'>\n                                <div class='"+Ee.HEADER_OPTIONS_BUTTONS_CONTAINER+"'>\n                                    <a class='"+Ee.HEADER_OPTIONS_BUTTON+"' href='javascript:;' data-export='calendar' data-format='pdf'>Export to .pdf</a>\n                                    <a class='"+Ee.HEADER_OPTIONS_BUTTON+"' href='javascript:;' data-export='calendar' data-format='docx'>Export to .docx</a>\n                                </div>\n                                <span class='caret'></span>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                {view-options}\n            </div>\n        ").trim(),VIEWS:"<div class='"+Ee.VIEWS_LIST_CONTAINER+"'><ul class='"+Ee.VIEWS_LIST+"'><li class='"+Ee.VIEWS_ITEM+"'><button type='button' class='"+Ee.VIEW_BUTTON+" daily' data-toggle='calendar-view' data-option='daily'>Daily</button></li><li class='"+Ee.VIEWS_ITEM+"'><button type='button' class='"+Ee.VIEW_BUTTON+" weekly' data-toggle='calendar-view' data-option='weekly'>Weekly</button></li><li class='"+Ee.VIEWS_ITEM+"'><button type='button' class='"+Ee.VIEW_BUTTON+" monthly' data-toggle='calendar-view' data-option='monthly'>Monthly</button></li></ul></div>",CONTROL:"<button class='"+Ee.CONTROLS_CONTAINER+"' type='submit' {direction}>{label}</button>",ADD_MENU:"<div class='"+Ee.ADD_MENU_CONTAINER+"' id='addMenuComponent'><div class='"+Ee.ADD_MENU_INNER+"'><div class='"+Ee.ADD_MENU_BUTTONS_CONTAINER+"'><button class='"+Ee.ADD_MENU_BUTTON+"' type='button' data-action='add-event'>Add Event</button><button class='"+Ee.ADD_MENU_BUTTON+" cancel' data-action='cancel' type='button'>Cancel</button></div><span class='caret'></span></div></div>"},Te={spring:{display_name:"Spring",months:[3,4,5,6]},summer:{display_name:"Summer",months:[7,8,9]},fall:{display_name:"Fall",months:[10,11]},winter:{display_name:"Winter",months:[12,1,2]}},_e=["January","February","March","April","May","June","July","August","September","October","November","December"],t=function(){var _=this;this.now=new Date,this.selection=[],this.createFormModal=null,this.editFormModal=null,this.events=[],this.eventInstances=[],this.viewOptions=["daily","weekly","monthly"];var o=moment(moment().format("YYYY-MM-DD 00:00:00")),l=moment(o).add(6,"days"),a=moment();this.settings={},this.init=function(e,t){_.el=e,_.settings=pe.extend({month:_.now.getMonth()+1,year:_.now.getFullYear(),dayStyle:"short",cellMaxHeigh:200,respData:"data",id:"id",title:"title",startDate:"startDate",endDate:"endDate",startTime:"startTime",endTime:"endTime",creatRequest:null,editRequest:null,view:"monthly",changableView:!0,form:[],disableForm:!1,escCloseEventMenu:!0,escCloseAddMenu:!0},t);var n=pe.extend(Te,t?t.seasons:{});return _.settings.seasons=n,(_.settings.month<1||12<_.settings.month)&&(_.settings.month=1),setupForm(),s(),"destroy"==t&&_.destroy(),_};var s=function(){e(),_.createFormModal=new CPEventFormModal("new-event"+_.now.getTime(),{url:_.settings.createUrl||_.settings.url||null,data:_.settings.data,headers:_.settings.headers,onSaved:ie,requestStruct:_.settings.creatRequest||null,fieldsList:_.settings.form}),_.createFormModal.render(),_.editFormModal=new CPEventFormModal("edit-event"+_.now.getTime(),{editting:!0,url:_.settings.editUrl||_.settings.url||null,deleteUrl:_.settings.deleteUrl||_.settings.url||null,data:_.settings.data,headers:_.settings.headers,onSaved:ie,onDelete:ie,requestStruct:_.settings.editRequest||null,fieldsList:_.settings.form}),_.editFormModal.render()};setupForm=function(){var e=_.settings.form,t={};if(e&&e.constructor==Array){_.formFields={};for(var n=0;n<e.length;n++)if(null!=e[n])if(e[n].constructor==Array)for(var i=0;i<e[n].length;i++)t[e[n][i].name]=_extends({},e[n][i]),_.formFields[e[n][i].name]=e[n][i].defaultValue||"";else console.warn("Form structure malformed at fields list "+n+" form must have the following structure in order to render. Array<Array<object>>")}};var e=function(){var e="";switch(_.settings.view){case"daily":e=n();break;case"weekly":e=t();break;case"monthly":e=createView(v())}pe(_.el).html(""),pe(e).prependTo(pe(_.el)),ie(),p()},t=function(){return"<div class='"+Ee.CONTAINER+"' id='"+ve.CONTAINER_ID+"'>"+N("weekly")+"<table class='"+Ee.CALENDAR+" weekly'  cellspacing='0' cellpadding='0'><thead>"+d()+"</thead><tbody>"+u()+"</tbody></table>"+y()+b()+"</div>"},n=function(){return"<div class='"+Ee.CONTAINER+"' id='"+ve.CONTAINER_ID+"'>"+N("daily")+"<table class='"+Ee.CALENDAR+" daily'  cellspacing='0' cellpadding='0'><thead>"+r()+"</thead><tbody>"+c()+"</tbody></table>"+y()+b()+"</div>"},b=function(){return("\n                <div class='"+Ee.EVENT_MENU_CONTAINER+"' id='eventMenuComponent'>\n                    <div class='"+Ee.EVENT_MENU_INNER+"'>\n                        <div class='"+Ee.EVENT_MENU_BUTTONS_CONTAINER+"'>\n                            <button class='"+Ee.EVENT_MENU_BUTTON+"' type='button' data-action='edit-event'>Edit Event</button>\n                            <button class='"+Ee.EVENT_MENU_BUTTON+"' type='button' data-action='copy-event'>Copy Event</button>\n                            <button class='"+Ee.EVENT_MENU_BUTTON+" cancel' data-action='delete-event' type='button'>Delete Event</button>\n                            <button class='"+Ee.EVENT_MENU_BUTTON+" cancel' data-action='cancel' type='button'>Cancel</button>\n                        </div>\n                        <span class='caret'></span>\n                    </div>\n                </div>\n            ").trim()},r=function(){return'<tr class="'+Ee.MONTH_HEADING+'"><th>Time</th><th></th></tr>'},c=function(){for(var e,t=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],n="",i=0;i<t.length;i++)e=12<=i?"PM":"AM",n+='<tr class="'+Ee.WEEK_ROW+' daily">\n                            <td>'+fe(t[i])+" "+e+'</td>\n                            <td class="'+Ee.DATE_CELL+" "+Ee.DATE_DAY+'" data-date="'+moment(a.format("YYYY-MM-DD "+fe(t[i])+":00:00")).get("time")+'">\n                                <div class="'+Ee.DATE_CELL_CONTENT+'"></div>\n                            </td>\n                        </tr>';return n},d=function(){for(var e='<tr class="'+Ee.MONTH_HEADING+'"><th>Time</th>',t=o.get("time");t<=l.get("time");t+=864e5)e+="<th >"+moment(t).format("ddd DD")+"</th>";return e+="</tr>"},u=function(){for(var e,t,n,i=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],a="",s=0;s<i.length;s++){n=12<=s?"PM":"AM",e=fe(i[s])+" "+n,a+='<tr class="'+Ee.WEEK_ROW+' weekly"><td style=" text-align: right; padding-right: 15px;">'+e+"</td>";for(var r=o.get("time");r<=l.get("time");r+=864e5)t=moment(moment(r).format("YYYY-MM-DD ")+fe(i[s])+":00:00"),a+='<td class="'+Ee.DATE_CELL+" "+Ee.DATE_DAY+'" data-date="'+t.get("time")+'"><div class="'+Ee.DATE_CELL_CONTENT+'"></div></td>';a+="</tr>"}return a},N=function(e){var t=Q(_.settings.month-1);t+=" "+_.settings.year;var n="";if(n+=" "+Ee.MONTH_HEADER.replace("{month}",Q(_.settings.month-1).toLowerCase())+" ",n+=" "+Ee.SEASON_HEADER.replace("{season}",ee()?ee().name:"")+" ","weekly"==e){t=Q(o.get("month"));n+=" "+Ee.MONTH_HEADER.replace("{month}",Q(o.get("month")-1).toLowerCase())+" ",t+=" "+fe(o.get("date"))+" - ",t+=l.get("month")!=o.get("month")?Q(l.get("month"))+" "+fe(l.get("date")):fe(l.get("date"))}if("daily"==e){t=a.format("Do MMMM YYYY");n+=" "+Ee.MONTH_HEADER.replace("{month}",Q(a.get("month")-1).toLowerCase())+" "}return"\n                <div class='"+Ee.HEADER+" "+n+"'>\n                    <div class='"+Ee.NAV_CONTROLS+"'>\n                        "+h("left")+"\n                        <button class='"+Ee.MONTH_NAME_BUTTON+"'>\n                            "+t+"<span class='caret'></span>\n                        </button>\n                        "+h("right")+"\n                    </div>\n                    <div class='"+Ee.HEADER_CONTENT+"'>\n                        <div class='"+Ee.HEADER_OPTIONS_CONTAINER+"'>\n                            <div class='"+Ee.HEADER_OPTIONS+"' id='headerOptionsComponent'>\n                                <div class='"+Ee.HEADER_OPTIONS_INNER+"'>\n                                    <div class='"+Ee.HEADER_OPTIONS_BUTTONS_CONTAINER+"'>\n                                        <a class='"+Ee.HEADER_OPTIONS_BUTTON+"' href='javascript:;' data-export='calendar' data-format='pdf'>Export to .pdf</a>\n                                        <a class='"+Ee.HEADER_OPTIONS_BUTTON+"' href='javascript:;' data-export='calendar' data-format='docx'>Export to .docx</a>\n                                    </div>\n                                    <span class='caret'></span>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    "+f()+"\n                </div>\n            "},h=function(e){var t="right"==e?"&rarr;":"&larr;";return"<button class='"+Ee.CONTROLS_CONTAINER+"' type='submit' "+e+">"+t+"</button>"},f=function(){return _.settings.changableView?"<div class='"+Ee.VIEWS_LIST_CONTAINER+"'><ul class='"+Ee.VIEWS_LIST+"'><li class='"+Ee.VIEWS_ITEM+"'><button type='button' class='"+Ee.VIEW_BUTTON+" daily' data-toggle='calendar-view' data-option='daily'>Day</button></li><li class='"+Ee.VIEWS_ITEM+"'><button type='button' class='"+Ee.VIEW_BUTTON+" weekly' data-toggle='calendar-view' data-option='weekly'>Week</button></li><li class='"+Ee.VIEWS_ITEM+"'><button type='button' class='"+Ee.VIEW_BUTTON+" monthly' data-toggle='calendar-view' data-option='monthly'>Month</button></li></ul></div>":""},y=function(){if(_.settings.disableForm)return"";var e="";return _.copiedEvent&&(e=Ee.SHOW_COPIED_EVENT_MENU),("\n                <div class='"+Ee.ADD_MENU_CONTAINER+" "+e+"' id='addMenuComponent'>\n                    <div class='"+Ee.ADD_MENU_INNER+"'>\n                        <div class='"+Ee.ADD_MENU_BUTTONS_CONTAINER+"'>\n                            <button \n                                class='"+Ee.ADD_MENU_BUTTON+" anti-copied-button' \n                                type='button' data-action='add-event'\n                            >\n                                Add Event\n                            </button>\n                            <button \n                                class='"+Ee.ADD_MENU_BUTTON+" copied-button' \n                                type='button' data-action='paste-event'\n                            >\n                                Paste Event\n                            </button>\n                            <button \n                                class='"+Ee.ADD_MENU_BUTTON+" copied-button cancel'\n                                data-action='cancel-copy'\n                                type='button'\n                            >\n                                Clear Copy\n                            </button>\n                            <button \n                                class='"+Ee.ADD_MENU_BUTTON+" destructive'\n                                data-action='cancel'\n                                type='button'\n                            >\n                                Cancel\n                            </button>\n                        </div>\n                        <span class='caret'></span>\n                    </div>\n                </div>\n            ").trim()},E=function(){for(var e=0;e<_.eventInstances.length;e++){_.eventInstances[e].destroy()}_.eventInstances=[]},p=function(){var e=ve.CONTAINER,t=ve.ADD_MENU_BUTTON,n=ve.EXPORT_BUTTON,i=ve.EVENT_MENU_BUTTON;g(),pe(window).off("resize",g),pe(window).on("resize",g),C(),pe(window).off("resize",C),pe(window).on("resize",C),pe(_.el).find(e).find(t).off("click",k),pe(_.el).find(e).find(t).on("click",k),pe(_.el).find(e).find(i).off("click",M),pe(_.el).find(e).find(i).on("click",M),pe(_.el).find(e).find(n).off("click",ce),pe(_.el).find(e).find(n).on("click",ce),document.removeEventListener("keyup",x),document.addEventListener("keyup",x),D(),Y(),X(),he(),de()};createView=function(e){for(var t=Z(me.CONTAINER),n=Z(me.MAIN),i=Z(me.DAYS_HEADING),a=Z(me.DAY_CELL),s=Z(me.WEEK_ROW),r=Q(_.settings.month-1),o=ee(),l="",c=0;c<e.length;c++){for(var d="",u=0;u<e[c].length;u++){var h="",f=e[c][u].toString(),p=e[c][u-1]?e[c][u-1].toString():"",E=a.replace("{content}",e[c][u]);if(f.length<1)h+=" "+Ee.EMPTY_DAY+" ",0==u&&f.length<1&&(h+=" "+Ee.EMPTY_DAY_BEGINNING+" "),p&&O()==p.trim()&&(h+=" "+Ee.EMPTY_DAY_ENDING+" "),E=E.replace("{date}","");else{h+=" "+Ee.DATE_DAY;var v=new Date(_.settings.month+"/"+e[c][u]+"/"+_.settings.year);E=E.replace("{date}",v.getTime())}d+=E=E.replace("{classnames}",h)}var m=Z(s);l+=(m=m.replace("{row}",c+1)).replace("{content}",d)}var T="monthly";return T+=" "+Ee.MONTH_CALENDAR.replace("{month}",r.toLowerCase())+" ",T+=" "+Ee.SEASON_CALENDAR.replace("{season}",o?o.name:"")+" ",n=(n=(n=n.replace("{content}",l)).replace("{heading}",i)).replace("{classnames}",T),t=(t=(t=(t=t.replace("{header}",N())).replace("{calendar}",n)).replace("{add_menu}",y())).replace("{event_menu}",b())};var v=function(){var e=O(_.settings.month,_.settings.year),t=new Date(_.settings.year,_.settings.month-1,1).getDay();return z(m(t,e),7)},m=function(e,t){var n=[];for(i=0;i<35;i++)i>=e&&i-e<t?n.push(i-e+1):n.push("");return n},O=function(e,t){var n,i="number"==typeof e?e.toString():e;return-1!=["1","3","5","7","8","10","12"].indexOf(i)?n=31:-1!=["4","6","9","11","8"].indexOf(i)?n=30:2==e&&(n=T(t)?29:28),n},T=function(e){return e%4==0},g=function(){var e=ve.CONTAINER,t=ve.CALENDAR,n=ve.WEEK_ROW,i=ve.DATE_CELL,a=ve.DATE_CELL_CONTENT,s=pe(_.el).find(e+" "+t+" "+n+" "+i),r=pe(s[0]).outerWidth()>_.settings.cellMaxHeigh?_.settings.cellMaxHeigh+"px":pe(s[0]).outerWidth()+"px";"monthly"!=_.settings.view&&(r="initial"),s.find(a).css({height:r}),K()},C=function(){for(var e=ve.CONTAINER,t=ve.CALENDAR,n=ve.WEEK_ROW,i=ve.DATE_CELL,a=pe(_.el).find(e+" "+t+" "+n+" "+i),s=pe(_.el).find(a[0]).outerWidth(),r=0,o=0;o<a.length;o++){var l=a.eq(o);if(l.hasClass(Ee.EMPTY_DAY)){var c=r*s;c=c<=0?0:-c,l.css({backgroundPosition:c+"px 0px"}),r++}}},D=function(){var e=Z(ve.CONTROL_BUTTONS);pe(_.el).find(e).off("click",A),pe(_.el).find(e).on("click",A)},A=function(e){var t=e.target,n=pe(t).attr("left"),i=pe(t).attr("right"),a=Z(_.settings),s=void 0!==n?"left":void 0;s=void 0!==i?"right":s,"monthly"==a.view&&S(s),"weekly"==a.view&&I(s),"daily"==a.view&&R(s),H()},S=function(e){var t=Z(_.settings);"left"==e?(t.year=t.month<=1?t.year-1:t.year,t.month=t.month<=1?t.month=12:t.month-1):"right"==e&&(t.year=12<=t.month?t.year+1:t.year,t.month=12<=t.month?t.month=1:t.month+1),_.settings=pe.extend({},_.settings,t);var n=moment();o=n.get("month")+1==t.month&&n.get("year")==t.year?moment(t.year+"-"+fe(t.month)+"-"+fe(n.get("date"))):moment(t.year+"-"+fe(t.month)+"-01"),l=moment(o).add(6,"days"),a=moment(o),s()},I=function(e){Z(_.settings);"left"==e?o=moment(o).subtract(8,"day"):"right"==e&&(o=moment(l).add(1,"day")),l=moment(o).add(6,"day");moment();_.settings=pe.extend({},_.settings,{year:o.get("year"),month:o.get("month")+1}),a=moment(o),s()},R=function(e){Z(_.settings);"left"==e?a=moment(a).subtract(1,"day"):"right"==e&&(a=moment(a).add(1,"day")),(a.get("time")<o.get("time")||a.get("time")>l.get("time"))&&(o=moment(a),l=moment(o).add(6,"days")),_.settings=pe.extend({},_.settings,{year:a.get("year"),month:a.get("month")+1}),s()},w=function(e){var t=ve.CONTAINER,n=ve.ADD_MENU_CONTAINER,i=pe(_.el).find(t).find(n);!e&&0<i.length&&!i.hasClass(Ee.SHOW_COPIED_EVENT_MENU)&&i.addClass(Ee.SHOW_COPIED_EVENT_MENU),e&&0<i.length&&i.hasClass(Ee.SHOW_COPIED_EVENT_MENU)&&i.removeClass(Ee.SHOW_COPIED_EVENT_MENU)},k=function e(t){var n=ve.CONTAINER,i=ve.ADD_MENU_BUTTON;switch(pe(_.el).find(n).find(i).off("click",e),pe(t.currentTarget).attr("data-action")){case"add-event":L();break;case"paste-event":U();break;case"cancel-copy":j();break;case"cancel":V()}p()},M=function(e){var t=ve.CONTAINER,n=ve.ADD_MENU_BUTTON;switch(pe(_.el).find(t).find(n).off("click",k),pe(e.currentTarget).attr("data-action")){case"edit-event":_.editFormModal.show(Object.assign({},_.formFields,_.selectedEvent),_.selectedEvent.id);break;case"copy-event":P(_.selectedEvent);break;case"delete-event":if(!confirm("Are you sure you want to delete, this event?"))return;F(_.selectedEvent.id);break;case"cancel":H()}H(),p()},P=function(e){_.copiedEvent=Object.assign({},e),w()},L=function(){var e=0<_.selection.length?_.selection[0]:null,t=1<_.selection.length?_.selection[1]:e;if(null!=e){var n={startDate:new Date(e),endDate:new Date(t)};_.createFormModal.show(Object.assign({},_.formFields,n)),V()}},U=function(){var e=0<_.selection.length?_.selection[0]:null,t=1<_.selection.length?_.selection[1]:e;if(null!=e){var n=new Date(e),i=new Date(t),a=Object.assign({},_.copiedEvent,{startDate:n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear(),endDate:i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear()},_.settings.data||{});pe.ajax({url:_.settings.createUrl||_.settings.url,data:a,headers:_.settings.headers,method:"POST"}).done(function(){alert("Event pasted to date successfully!"),ie()}).fail(function(e){var t="Failed to paste event to date.";t=e.message&&0<e.message.length?e.message:t;alert(t)}),V(),j()}},F=function(e){e&&_.settings.deleteUrl&&(pe.ajax({url:_.settings.deleteUrl.replace(":id",e),headers:_.settings.headers,method:"POST"}).done(function(){ie()}).fail(function(e){var t="Could not delete event, please try again in a moment.";t=e.message&&0<e.message.length?e.message:t;alert(t)}),V(),j())},j=function(){_.copiedEvent=void 0,w(!0)},V=function(){_.selection=[],X()},H=function(){B(!0),_.selectedEvent=void 0,_.selectedEventTarget=void 0,G()},x=function(e){e&&27==e.keyCode&&(_.selectedEvent&&_.settings.escCloseEventMenu&&H(),_.settings.escCloseAddMenu&&_.selection&&0<_.selection.length&&V())},W=function(e,t){if(!_.settings.disableForm){var n=new Date(e.startDate),i=new Date(e.endDate),a=Object.assign({},e,{title:e.title,startDate:n,endDate:i,startTime:e.startTime,endTime:e.endTime});B(!0),_.selectedEvent=Object.assign({},a),_.selectedEventTarget=pe(t.currentTarget),B(),G()}},B=function(e){if(_.selectedEventTarget){var t=pe(_.el).find(".cp-ev-event[data-evid="+_.selectedEventTarget.attr("data-evid")+"]");if(0<t.length){if(e)return void t.removeClass("cp-ev-event-selected");t.addClass("cp-ev-event-selected")}}},Y=function(){var e=ve.DATE_DAY;pe(_.el).find(e).off("click",$),pe(_.el).find(e).on("click",$)},$=function e(t){var n=ve.DATE_DAY;if(pe(_.el).find(n).off("click",e),!_.settings.disableForm){var i=t.currentTarget;if(!pe(t.target).hasClass("cp-ev-event")&&!pe(t.target).hasClass("cp-ev-event-label")){var a=pe(i).attr("data-date"),s=0<_.selection.length?_.selection[0]:0,r=1<_.selection.length?_.selection[1]:s;null!=a&&(a=parseInt(a),s<1||0<s&&a<s?_.selection[0]=a:a==s&&r==s?_.selection=[]:a==s?_.selection=[s]:_.selection[1]=a),X()}Y()}},X=function(){var e=ve.CALENDAR,t=ve.DATE_DAY,n=Ee.DATE_SELECTED,i=pe(_.el).find(e).find(t),a=0<_.selection.length?_.selection[0]:0,s=1<_.selection.length?_.selection[1]:a;if(i&&0<i.length)for(var r=0;r<i.length;r++){var o=i.eq(r),l=pe(o).attr("data-date");if(null!=l)a<=(l=parseInt(l))&&l<=s?pe(o).hasClass(n)||pe(o).addClass(n):pe(o).hasClass(n)&&pe(o).removeClass(n)}q()},q=function(){var e=ve.CONTAINER,t=ve.ADD_MENU_CONTAINER,n=ve.DATE_SELECTED,i=Ee.ADD_MENU_VISIBLE,a=pe(_.el).find(e),s=a.find(n),r=a.find(t);s&&0<s.length?r.hasClass(i)||(r.addClass(i),H()):r.hasClass(i)&&r.removeClass(i),K()},G=function(){var e=ve.CONTAINER,t=ve.EVENT_MENU_CONTAINER,n=ve.DATE_SELECTED,i=Ee.EVENT_MENU_VISIBLE,a=pe(_.el).find(e),s=(a.find(n),a.find(t));_.selectedEventTarget&&0<_.selectedEventTarget.length?s.hasClass(i)||(s.addClass(i),V()):(s.hasClass(i)&&s.removeClass(i),_.selectedEventTarget=void 0),J()},J=function(){var e=ve.EVENT_MENU_CONTAINER,t=ve.CONTAINER,n=Ee.EVENT_MENU_ABOVE,i=_.selectedEventTarget,a=pe(_.el).find(t),s=a.find(e),r=ne();if(null!=i&&null!=i){var o=i.offset(),l=o?o.left:0,c=o?o.top+i.outerHeight()-10-a.position().top:0;i.outerWidth()>s.outerWidth()?l+=(i.outerWidth()-s.outerWidth())/2:l-=(s.outerWidth()-i.outerWidth())/2,s.outerHeight()+c>r.height?(c=o?o.top-s.outerHeight()+10:0,s.hasClass(n)||s.addClass(n)):s.hasClass(n)&&s.removeClass(n),s.css({top:c,left:l})}},K=function(){var e=ve.ADD_MENU_CONTAINER,t=ve.CONTAINER,n=Ee.ADD_MENU_ABOVE,i=te(),a=pe(_.el).find(t),s=a.find(e),r=ne();if(null!=i&&null!=i){var o=i.offset(),l=o?o.left:0,c=o?o.top+i.outerHeight()-10-a.position().top:0;i.outerWidth()>s.outerWidth()?l+=(i.outerWidth()-s.outerWidth())/2:l-=(s.outerWidth()-i.outerWidth())/2,s.outerHeight()+c>r.height?(c=o?o.top-s.outerHeight()+10:0,s.hasClass(n)||s.addClass(n)):s.hasClass(n)&&s.removeClass(n),s.css({top:c,left:l})}},z=function(e,t){for(var n=[],i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n},Z=function(e){return JSON.parse(JSON.stringify(e))},Q=function(e){return null==_e[e]?"":_e[e]},ee=function(){for(var e in _.settings.seasons){var t=_.settings.seasons[e];if(null!=t&&-1!=t.months.indexOf(_.settings.month))return{name:e,display_name:t.display_name}}return null},te=function(){var e=0<_.selection.length?_.selection[0]:null,t=1<_.selection.length?_.selection[1]:e,n=ve.CONTAINER;return t&&(t=pe(_.el).find(n).find('[data-date="'+t+'"]')),t},ne=function(){return{width:pe(document).outerWidth(),height:pe(document).outerHeight()}},ie=function(){i&&4!=i.readyState&&i.abort();var e=_.settings.getUrl||_.settings.url||null;if(e)var t=pe.extend({},_.settings.data,{month:_.settings.month,year:_.settings.year}),n=pe.extend({},_.settings.headers),i=pe.ajax({url:e,method:"GET",data:t,headers:n}).done(ae).fail(se)},ae=function(e){_.events=re(e),function(){E();for(var e,t,n,i,a,s=ve.CALENDAR,r=ve.WEEK_ROW,o=ve.DATE_CELL,l=ve.DATE_CELL_CONTENT,c=(pe(_.el).find(s).find(r),pe(_.el).find(s).find(o)),d=0;d<c.length;d++)if(t=c.eq(d),"number"==typeof(n=parseInt(t.attr("data-date")))&&0<=n)for(var u=0;u<_.events.length;u++){var h=_.events[u];if(i=new Date(h.startDate+" "+h.startTime).getTime(),a=new Date(h.endDate+" "+h.endTime).getTime(),n>=moment(moment(i).format("YYYY-MM-DD 00:00:00")).get("time")&&n<=moment(moment(a).format("YYYY-MM-DD 23:59:59")).get("time")){var f=moment(moment(n).format("YYYY-MM-DDT"+h.startTime)).get("time"),p=moment(moment(n).format("YYYY-MM-DDT"+h.endTime)).get("time");("monthly"==_.settings.view||f<=n&&n<=p)&&((e=new CPEvent(h,t.find(l),void 0,o,{onClick:W})).render(),_.eventInstances.push(e))}}}()},se=function(e){if("abort"!=e.statusText){var t="Failed to load events.";t=e.message&&0<e.message.length?e.message:t}},re=function(e){if(null===_.settings.respData)return e;if("string"!=typeof _.settings.respData)return console.error(new Error("Data path invalid, please contact system's admin.")),e;var t=Z(_.settings.respData);t=(t=t.trim()).split(".");for(var n=Z(e),i=0;i<t.length;i++)n.hasOwnProperty(t[i])&&(n=n[t[i]]);if(n)for(i=0;i<n.length;i++)n[i]=oe(n[i]);return n},oe=function(e){if(_.settings.map&&_.settings.map.constructor==Object){for(var t=Object.assign({},e),n=Object.keys(_.settings.map),i=0;i<n.length;i++)t[n[i]]=le(e,_.settings.map[n[i]]);return t}return e},le=function(e,t){if("string"!=typeof t)return console.error(new Error("Data path invalid, please contact system's admin.")),e;var n=Z(t);n=(n=n.trim()).split(".");for(var i=Z(e),a=!1,s=0;s<n.length;s++)i.hasOwnProperty(n[s])&&(i=i[n[s]],a=!0);return a?i:null},ce=function(e){e.preventDefault();var t=pe(e.currentTarget),n=ve.CONTAINER_ID;t.attr("data-format"),pe(_.el).find("#"+n)},de=function(){pe(_.el).find(ve.VIEW_SELECTOR).off("click",ue),pe(_.el).find(ve.VIEW_SELECTOR).on("click",ue)},ue=function(e){var t=pe(e.currentTarget).attr("data-option");-1==_.viewOptions.indexOf(t)&&(t="monthly"),_.settings.view!=t&&(_.settings=pe.extend({},_.settings,{view:t}),V(),setTimeout(s,200))},he=function(){var e=ve.VIEWS_LIST_CONTAINER,t=pe(_.el).find(e).find("[data-option='"+_.settings.view+"']");0<t.length&&(t.hasClass(Ee.ACTIVE)||(pe(_.el).find(e).find("[data-toggle='calendar-view']").removeClass(Ee.ACTIVE),t.addClass(Ee.ACTIVE)))},fe=function(e){return"number"==typeof e&&(e=e.toString()),2<=e.trim().length?e:"0"+e}};pe.fn.CalendarPlugin=function(e){(new t).init(this,e)},pe.fn.call=function(e,t,n){return e.apply(n||this,t),this}}(jQuery);var _createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var CPEvent=function(){function r(e,t,n,i,a){_classCallCheck(this,r);var s=new Date;this.PREFIX="cp-ev",this.uniqueID=this.PREFIX+s.getTime()+""+Math.ceil(100*Math.random()),this.container=t,this.week=n,this.cellSelector=i,this.event=null,this.data=e,this.start=null,this.options=$.extend({onClick:null},a),this.html=this.html.bind(this),this.render=this.render.bind(this),this.SELECTORS=this.SELECTORS.bind(this),this.CLASSNAMES=this.CLASSNAMES.bind(this),this.componentDidRender=this.componentDidRender.bind(this),this.reposition=this.reposition.bind(this),this.resize=this.resize.bind(this),this.set_start_end=this.set_start_end.bind(this),this.destroy=this.destroy.bind(this)}return _createClass(r,[{key:"SELECTORS",value:function(){return{BODY:"body",FORM:"."+this.PREFIX+"-form",FIELDSET:"fieldset",MODAL:"."+this.PREFIX+"-modal",BUTTON:"."+this.PREFIX+"-button",TITLE:'input[name="event-title"]',END_TIME:'input[name="end-time"]',END_DATE:'input[name="end-date"]',START_DATE:'input[name="start-date"]',START_TIME:'input[name="start-time"]',ERROR_CONTAINER:"."+this.PREFIX+"-error-container"}}},{key:"CLASSNAMES",value:function(){return{CONTAINER:this.PREFIX+"-event-container",EVENT:this.PREFIX+"-event",LABEL:this.PREFIX+"-event-label",START:"start",END:"end",HIGHLIGHTED:"highlighted"}}}]),_createClass(r,[{key:"componentDidRender",value:function(){this.event=this.container.find("#"+this.uniqueID),this.listeners()}},{key:"render",value:function(){this.container.append(this.html()),this.componentDidRender()}},{key:"html",value:function(){return"<button class='"+this.CLASSNAMES().EVENT+"' id='"+this.uniqueID+"' data-evid='"+this.data.id+"' title='"+this.title()+"'><span class='"+this.CLASSNAMES().LABEL+"'>"+this.data.title+"</span></button>"}},{key:"title",value:function(){return this.data.title+" ("+this.data.startDate+" - "+this.data.endDate+")"}},{key:"listeners",value:function(){"function"==typeof this.options.onClick&&(this.event.off("click",this.handle_on_click.bind(this)),this.event.on("click",this.handle_on_click.bind(this))),this.event.off("mouseenter",this.handle_on_mouse_enter.bind(this)),this.event.on("mouseenter",this.handle_on_mouse_enter.bind(this)),this.event.off("mouseleave",this.handle_on_mouse_leave.bind(this)),this.event.on("mouseleave",this.handle_on_mouse_leave.bind(this))}},{key:"handle_on_click",value:function(e){this.options.onClick(this.data,e)}},{key:"handle_on_mouse_enter",value:function(e){var t=this.event.attr("data-evid");null!=t&&$('[data-evid="'+t+'"]').addClass(this.CLASSNAMES().HIGHLIGHTED)}},{key:"handle_on_mouse_leave",value:function(e){var t=this.event.attr("data-evid");null!=t&&$('[data-evid="'+t+'"]').removeClass(this.CLASSNAMES().HIGHLIGHTED)}},{key:"reposition",value:function(){}},{key:"resize",value:function(){var e=new Date(this.data.startDate),t=new Date(this.data.endDate),n=this.start.offset().left,i=this.end.offset().left+this.end.outerWidth();e.getTime()==parseInt(this.start.attr("data-date"))&&(n+=15,this.event.hasClass(this.CLASSNAMES().START)||this.event.addClass(this.CLASSNAMES().START)),t.getTime()==parseInt(this.end.attr("data-date"))&&(i-=15,this.event.hasClass(this.CLASSNAMES().END)||this.event.addClass(this.CLASSNAMES().END));var a=i-n;this.event.css({width:a+"px"})}},{key:"set_start_end",value:function(){for(var e=new Date(this.data.startDate),t=new Date(this.data.endDate),n=this.week.find(this.cellSelector),i=null,a=null,s=0;s<n.length;s++){var r=n.eq(s),o=parseInt(r.attr("data-date"));if(null==i&&(i=o>=e.getTime()&&o<=t.getTime()||o==e.getTime()?r:null),null==a&&(n.length-1!=s&&o!=t.getTime()||(a=r)),null!=i&&null!=a)break}this.start=i,this.end=a}},{key:"destroy",value:function(){this.event.remove(),this.event=null}}]),r}(),_typeof=(_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e});_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var CPEventFormModal=function(){function i(e,t){var n=this;_classCallCheck(this,i),Object.defineProperty(this,"SELECTORS",{enumerable:!0,writable:!0,value:function(){return{BODY:"body",FORM:"."+n.PREFIX+"-form",FIELDSET:"fieldset",MODAL:"."+n.PREFIX+"-modal",BUTTON:"."+n.PREFIX+"-button",TITLE:'input[name="event-title"]',END_TIME:'input[name="end-time"]',END_DATE:'input[name="end-date"]',START_DATE:'input[name="start-date"]',START_TIME:'input[name="start-time"]',ERROR_CONTAINER:"."+n.PREFIX+"-error-container"}}}),Object.defineProperty(this,"CLASSNAMES",{enumerable:!0,writable:!0,value:function(){return{SHOW:"show",CANCEL:"cancel",SAVE:"save",DELETE:"delete"}}}),Object.defineProperty(this,"PREFIX",{enumerable:!0,writable:!0,value:"cp-ef"}),Object.defineProperty(this,"fields",{enumerable:!0,writable:!0,value:[]}),Object.defineProperty(this,"dateTimeFields",{enumerable:!0,writable:!0,value:[]}),Object.defineProperty(this,"flatpickrs",{enumerable:!0,writable:!0,value:null}),this.uniqueID=e,this.id=null,this.modal=null,this.options=Object.assign({url:null,edit:!1,onWillShow:null,onShown:null,onWillHide:null,onHidden:null,onDelete:null,fieldsList:[]},t),this.html=this.html.bind(this),this.render=this.render.bind(this),this.componentDidRender=this.componentDidRender.bind(this)}return _createClass(i,[{key:"componentDidRender",value:function(){this.modal=$("#"+this.uniqueID),this.listeners(),this.enableDateteFields()}},{key:"render",value:function(){var e=this,t=this.SELECTORS().BODY,n=$("#"+this.uniqueID);0<n.length&&n.remove(),$(this.html().trim()).attr("id",this.uniqueID).appendTo(t).call(function(){return e.renderFields()}).call(function(){return e.componentDidRender()})}},{key:"html",value:function(){var n=this;return('\n            <div class="'+this.PREFIX+'-modal">\n                <div class="'+this.PREFIX+'-backdrop">&nbsp;</div>\n                <div class="'+this.PREFIX+'-content">\n                    <div class="'+this.PREFIX+'-dialog">\n                        <form action="javascript:;" class="'+this.PREFIX+'-form" method="POST">\n                            <fieldset>\n                                '+(this.options.fieldsList.constructor==Array?this.options.fieldsList.map(function(e,t){return n.renderFieldsList(e,t)}).join(""):null)+'\n                                <div class="'+this.PREFIX+'-actions">\n                                    '+(this.options.editting?'<button type="button" class="'+this.PREFIX+'-button delete"> Delete </button>':"")+'\n                                    <button type="button" class="'+this.PREFIX+"-button "+this.CLASSNAMES().CANCEL+'">Cancel</button>\n                                    <button type="submit" class="'+this.PREFIX+"-button "+this.CLASSNAMES().SAVE+'">Save</button>\n                                </div>\n                            </fieldset>\n                        </form>\n                    </div>\n                </div>\n            </div>\n        ').trim()}},{key:"renderFieldsList",value:function(e,t){var n=this;if(e.constructor!=Array)return null;var i=""+this.uniqueID+this.PREFIX+"-group"+t;return('\n            <div\n                class="'+this.PREFIX+'-group"\n            >\n                '+e.map(function(e,t){return n.makeField(e,i,t)}).join("")+"\n            </div>\n        ").trim()}},{key:"makeField",value:function(e,t,n){var i=""+t+this.PREFIX+"-group-item"+n,a="#"+i,s=null;if(e&&"object"==(void 0===e?"undefined":_typeof(e))&&e.constructor==Object&&Object.keys(e))switch(e.type){case"text":s=new CPFText(a,_extends({},e,{modal:"#"+this.uniqueID}));break;case"date":s=new CPFDate(a,_extends({},e,{modal:"#"+this.uniqueID}));break;case"datetime":s=new CPFDatetime(a,_extends({},e,{modal:"#"+this.uniqueID})),this.dateTimeFields.push(s);break;case"select":s=new CPFSelect(a,_extends({},e,{modal:"#"+this.uniqueID}));break;case"radio":s=new CPFRadioGroup(a,_extends({},e,{modal:"#"+this.uniqueID}));break;case"time":s=new CPFTime(a,_extends({},e,{modal:"#"+this.uniqueID}))}return s&&this.fields.push(s),'<div class="'+this.PREFIX+'-group-item" id="'+i+'"></div>'}},{key:"fieldHtmlType",value:function(e){switch(e){case"select":return"select";case"long-text":return"textarea";default:return"input"}}},{key:"renderFields",value:function(){if(this.fields&&this.fields.constructor==Array)for(var e=0;e<this.fields.length;e++)this.fields[e].render()}},{key:"listeners",value:function(){var e=this.SELECTORS(),t=e.BUTTON,n=e.FORM;this.modal.find(t).off("click",this.handleButtonClick.bind(this)),this.modal.find(t).on("click",this.handleButtonClick.bind(this)),this.modal.find(n).off("submit",this.handleFormSubmit.bind(this)),this.modal.find(n).on("submit",this.handleFormSubmit.bind(this)),this.modal.find(n).off("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",this.handleFormTransitionEnd.bind(this)),this.modal.find(n).on("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",this.handleFormTransitionEnd.bind(this))}},{key:"enableDateteFields",value:function(){if(0<this.dateTimeFields.length&&void 0!==flatpickr){this.flatpickrs={};for(var e=0;e<this.dateTimeFields.length;e++){var t=this.dateTimeFields[e];this.flatpickrs[t.name]=$(t.containerSelector).find(t.fieldSelector).flatpickr({enableTime:!0,altFormat:"F J, Y \\a\\t h:i K",altInput:!0,dateFormat:"Y-m-d h:iK"})}}}},{key:"handleButtonClick",value:function(e){var t=this.CLASSNAMES(),n=t.CANCEL,i=(t.SAVE,t.DELETE),a=$(e.currentTarget);a.hasClass(n)&&this.hide(),a.hasClass(i)&&this.confirmDelete()}},{key:"handleFormSubmit",value:function(e){e.preventDefault(),this.validate()?this.showValidationError():(this.hideValidationError(),this.save())}},{key:"handleFormTransitionEnd",value:function(e){}},{key:"show",value:function(e,t){if(this.hasRendered()){this.reset(e),this.id=t||null;var n=this.CLASSNAMES().SHOW;this.modal.hasClass(n)||this.modal.addClass(n)}}},{key:"confirmDelete",value:function(){confirm("Are you sure you want to delete, this event?")&&this.delete()}},{key:"hide",value:function(){if(this.hasRendered()){var e=this.CLASSNAMES().SHOW;this.modal.hasClass(e)&&this.modal.removeClass(e)}}},{key:"hasRendered",value:function(){return null!=this.modal&&null!=this.modal&&0<this.modal.length}},{key:"reset",value:function(e){var t=void 0;this.hideValidationError();for(var n=0;n<this.fields.length;n++)"datetime"==(t=this.fields[n]).type&&this.flatpickrs&&this.flatpickrs.constructor==Object&&this.flatpickrs[t.name]?this.flatpickrs[t.name].setDate(e[t.name],!0):e.hasOwnProperty(t.name)&&t.setValue(e[t.name])}},{key:"formatDate",value:function(e){var t=e.getFullYear(),n=e.getMonth()+1,i=e.getDate();return this.leadingZero(n)+"/"+this.leadingZero(i)+"/"+t}},{key:"leadingZero",value:function(e){return"string"!=typeof e&&"number"!=typeof e?"0":("number"==typeof e&&(e=e.toString()),1<e.length?e:"0"+e)}},{key:"validate",value:function(){if(!this.modal)return"An unknow error has occured.";this.getFormData();return!1}},{key:"showValidationError",value:function(){var e=this.validate();if(e){var t=this.SELECTORS(),n=t.FORM,i=t.ERROR_CONTAINER,a=this.CLASSNAMES().SHOW,s=this.modal.find(n).find(i);!s||s.length<1||(s.text(e),s.hasClass(a)||s.addClass(a))}}},{key:"hideValidationError",value:function(){var e=this.SELECTORS(),t=e.FORM,n=e.ERROR_CONTAINER,i=this.CLASSNAMES().SHOW,a=this.modal.find(t).find(n);!a||a.length<1||(a.text(""),a.hasClass(i)&&a.removeClass(i))}},{key:"disable",value:function(e){var t=this.SELECTORS(),n=t.FORM,i=t.FIELDSET,a=t.BUTTON;e=!!e,this.modal.find(n).find(i).attr("disabled",e),this.modal.find(n).find(a).attr("disabled",e)}},{key:"timeRegex",value:function(e){"string"!=typeof e&&(e+="");return/^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/.test(e)}},{key:"getFormData",value:function(){for(var e={},t=0;t<this.fields.length;t++)this.fields[t].muted||(e[this.fields[t].name]=this.fields[t].getValue());return e}},{key:"save",value:function(){if(this.buildUrl()){var e=Object.assign({},this.options.data,this.getFormData());e=this.addStructs(e);var t=Object.assign({},this.options.headers);this.disable(!0),$.ajax({url:this.buildUrl(),data:e,headers:t,method:"POST"}).done(this.saveDone.bind(this)).fail(this.saveFailed.bind(this))}}},{key:"saveDone",value:function(e){"function"==typeof this.options.onSaved&&this.options.onSaved();var t=this;setTimeout(function(){t.disable(!1),t.hide()},800)}},{key:"saveFailed",value:function(e){this.disable(!1);var t="Failed to"+(this.options.editting?" save changes.":" save new event.");t=e.message&&0<e.message.length?e.message:t;alert(t)}},{key:"addStructs",value:function(e){if(this.options.requestStruct){var t=JSON.parse(JSON.stringify(this.options.requestStruct));for(var n in t)"string"==typeof t[n]&&void 0!==e[n]&&void 0===e[t[n]]&&(e[t[n]]=JSON.parse(JSON.stringify(e[n])),delete e[n])}return e}},{key:"delete",value:function(){var e=this.buildUrl("delete");if(null!=e){var t=Object.assign({},this.options.data),n=Object.assign({},this.options.headers);this.disable(!0),$.ajax({url:e,data:t,headers:n,method:"POST"}).done(this.deleteDone.bind(this)).fail(this.deleteFailed.bind(this))}}},{key:"deleteDone",value:function(e){"function"==typeof this.options.onDelete&&this.options.onDelete();var t=this;setTimeout(function(){t.disable(!1),t.hide()},800)}},{key:"deleteFailed",value:function(e){this.disable(!1);var t="Could not delete event, please try again in a moment.";t=e.message&&0<e.message.length?e.message:t;alert(t)}},{key:"buildUrl",value:function(e){if(!(e=!!e)&&null==this.options.url||e&&null==this.options.deleteUrl)return null;var t=e?JSON.parse(JSON.stringify(this.options.deleteUrl)):JSON.parse(JSON.stringify(this.options.url));return this.options.editting&&(t=t.replace(":id",this.id),this.options.data=Object.assign({},this.options.data,{id:this.id})),t}},{key:"destroy",value:function(){if(this.fields||this.fields.constructor==Array)for(var e=0;e<this.fields.length;e++)"datetime"==thie.field[e].type&&this.flatpickrs&&(this.flatpickrs.constructor,Object),this.flatpickrs[thie.field[e].name]&&this.flatpickrs[thie.field[e].name].destroy(),this.fields[e].destroy();$(this.uniqueID).remove(),this.fields=[]}}]),i}();_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var CPField=function(){function i(e,t){_classCallCheck(this,i),Object.defineProperty(this,"container",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(this,"props",{enumerable:!0,writable:!0,value:{}}),Object.defineProperty(this,"prefix",{enumerable:!0,writable:!0,value:"cp-ef"}),Object.defineProperty(this,"id",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(this,"type",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(this,"state",{enumerable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(this,"idAttribute",{enumerable:!0,writable:!0,value:"data-cpf-id"}),Object.defineProperty(this,"fieldSelector",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerSelector",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(this,"value",{enumerable:!0,writable:!0,value:null}),Object.defineProperty(this,"muted",{enumerable:!0,writable:!0,value:!1}),this.container=e,this.props=Object.assign({},this.props,t);var n=new Date;this.id=""+n.getTime()+2e3*Math.random(),this.name=t.name||null,this.fieldSelector=this.htmlType()+'[name="'+this.name+'"]',this.containerSelector="["+this.idAttribute+'="'+this.id+'"]'}return _createClass(i,[{key:"render",value:function(){$(this.container).call(this.handleWillRender.bind(this)).html(this.content().trim()).call(this.handleCompletedRender.bind(this))}},{key:"label",value:function(){return"string"==typeof this.props.label?('\n                <label \n                    for="'+this.props.name+'"\n                >\n                    '+this.props.label+"\n                </label>\n            ").trim():null}},{key:"placeholder",value:function(){return"string"==typeof this.props.placeholder&&0<this.props.placeholder.trim().length?this.props.placeholder:null}},{key:"handleWillRender",value:function(){"function"==typeof this.willRender&&this.willRender()}},{key:"handleCompletedRender",value:function(){"function"==typeof this.completedRender&&this.completedRender(),this.initiateListener(),this.props.bindTo&&"string"==typeof this.props.bindTo.name&&this.handleSiblinOnChange(),this.initiateBound()}},{key:"setDefaultValue",value:function(){if(null!=this.props.defaultValue)switch(this.type){case"text":case"time":$(this.containerSelector).children('input[type="'+this.type+'"]').val(this.props.defaultValue);break;case"radio":$(this.containerSelector).children('input[value="'+this.props.defaultValue+'"]').props("checked",!0);break;case"date":$(this.containerSelector).children('input[type="date"]').val(this.formatDate(this.props.defaultValue))}}},{key:"formatDate",value:function(e){var t=(e=new Date(e)).getFullYear(),n=e.getMonth()+1,i=e.getDate();return t+"-"+this.leadingZero(n)+"-"+this.leadingZero(i)}},{key:"leadingZero",value:function(e){return"string"!=typeof e&&"number"!=typeof e?"0":("number"==typeof e&&(e=e.toString()),1<e.length?e:"0"+e)}},{key:"setState",value:function(e,t){var n=_extends({},this.state);this.state=Object.assign({},n,e),"function"==typeof t&&t(),"function"==typeof this.componentChanged&&(this.componentChanged(n),this.setDefaultValue())}},{key:"setValue",value:function(e){"date"==this.type&&(e=this.formatDate(e)),"datetime"!=this.type&&$(this.containerSelector).children(this.fieldSelector).val(e)}},{key:"getValue",value:function(){return this.value}},{key:"htmlType",value:function(){switch(this.props.type){case"long-text":return"textarea";case"select":return"select";default:return"input"}}},{key:"initiateBound",value:function(){var e=this;this.props.bindTo&&($(this.props.modal).find(this.props.bindTo.name).off("change keyup",function(){return e.handleSiblinOnChange()}),$(this.props.modal).find(this.props.bindTo.name).on("change keyup",function(){return e.handleSiblinOnChange()}))}},{key:"handleSiblinOnChange",value:function(){var e=this.props.bindTo&&"string"==typeof this.props.bindTo.when&&this.props.bindTo.when.split("|")||[],t=void 0,n=void 0,i=$(this.props.modal).find(""+this.props.bindTo.name),a=0<i.length&&i[0].tagName||null,s=a&&i[0].type||null;a&&s&&("INPUT"==a&&"radio"==s?t=(n=$(this.props.modal).find(this.props.bindTo.name+":checked")).val():"INPUT"==a&&"checkbox"==s?n=$(this.props.modal).find(""+this.props.bindTo.name):t=(n=$(this.props.modal).find(this.props.bindTo.name)).val()),"checkbox"==s?":checked"==this.props.bindTo.when?this.muted=!n.is(this.props.bindTo.when):this.muted=n.is(this.props.bindTo.when):this.muted=-1==e.indexOf(t),this.muted?$(this.container).addClass("muted"):$(this.container).removeClass("muted")}},{key:"initiateListener",value:function(){var t=this;$(this.containerSelector).find(this.fieldSelector).off("change keyup",function(e){return t.handleOnChange(e)}),$(this.containerSelector).find(this.fieldSelector).on("change keyup",function(e){return t.handleOnChange(e)})}},{key:"handleOnChange",value:function(e){this.value=e.target.value}},{key:"destory",value:function(){var t=this;$(this.containerSelector).find(this.fieldSelector).off("change keyup",function(e){return t.handleOnChange(e)}),this.props.bindTo&&$(this.props.modal).find(this.props.bindTo.name).on("change keyup",function(e){return t.handleSiblinOnChange(e)}),$(this.containerSelector).remove()}}]),i}(),AllowedCPFTypes=["select","text","long-text","email","color-picker","date","time","image","number","phone","pdf","word-doc","spreadsheet","checkbox"];_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CPFDate=function(e){function i(e,t){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return n.type="date",n}return _inherits(i,CPField),_createClass(i,[{key:"content",value:function(){return'\n            <div class="'+this.prefix+'-control-group" '+this.idAttribute+'="'+this.id+'">\n                '+this.label()+'\n                <input \n                    type="date"\n                    name="'+this.props.name+'"\n                    autoComplete="off"\n                    class="'+this.prefix+'-form-control"\n                    '+(this.placeholder()?'placeholder="'+this.placeholder()+'"':"DD/MM/YYYY")+"\n                />\n            </div>\n        "}}]),i}();_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CPFDatetime=function(e){function i(e,t){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return n.type="datetime",n}return _inherits(i,CPField),_createClass(i,[{key:"content",value:function(){return'\n            <div class="'+this.prefix+'-control-group" '+this.idAttribute+'="'+this.id+'">\n                '+this.label()+'\n                <input \n                    type="text"\n                    name="'+this.props.name+'"\n                    autoComplete="off"\n                    class="'+this.prefix+'-form-control"\n                    placeholder="'+(this.placeholder()||"")+'"\n                />\n            </div>\n        '}}]),i}();_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CPFRadioGroup=function(e){function i(e,t){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return Object.defineProperty(n,"renderOptions",{enumerable:!0,writable:!0,value:function(e,t){return(' \n            <div\n                class="'+n.prefix+'-form-control radio-group"\n            >\n                <label class="'+n.prefix+'-radio-option">\n                    <input\n                        name="'+n.props.name+'"\n                        type="radio" \n                        value="'+e+'"\n                        '+(n.props.defaultValue==e?"checked":"")+"\n                    />\n                    <span>"+t+"</span>\n                </label>\n            </div>\n        ").trim()}}),n.type="radio",n}return _inherits(i,CPField),_createClass(i,[{key:"content",value:function(){var t=this;if(this.props.options.constructor!=Object)return"";var n=_extends({},this.props.options),e=Object.keys(n);return'\n            <div class="'+this.prefix+'-control-group radio-group" '+this.idAttribute+'="'+this.id+'">\n                '+this.label()+"\n                "+e.map(function(e){return t.renderOptions(e,n[e])}).join("")+"\n            </div>\n        "}},{key:"setValue",value:function(e){if("radio"==this.type){var t=$(this.containerSelector).find(this.fieldSelector+":checked");return 0<t.length&&t.prop("checked",!1).trigger("change"),void $(this.containerSelector).find(this.htmlType()+'[value="'+e+'"]').prop("checked",!0).trigger("change")}}},{key:"getValue",value:function(){for(var e=$(this.containerSelector).find(this.fieldSelector),t=0;t<=e.length;t++){var n=e.eq(t);if(n.is(":checked"))return n.val()}return""}}]),i}();_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CPFSelect=function(e){function i(e,t){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return Object.defineProperty(n,"renderOptions",{enumerable:!0,writable:!0,value:function(e,t){return('<option \n            value="'+e+'"\n            '+(n.props.defaultValue==e?"selected":"")+"\n        >\n            "+t+"\n        </option>").trim()}}),n.type="select",n}return _inherits(i,CPField),_createClass(i,[{key:"content",value:function(){var t=this;if(this.props.options.constructor!=Object)return"";var n=_extends({"":this.placeholder()},this.props.options),e=Object.keys(n);return'\n            <div class="'+this.prefix+'-control-group" '+this.idAttribute+'="'+this.id+'">\n                '+this.label()+'\n                <select\n                    name="'+this.props.name+'"\n                    class="'+this.prefix+'-form-control"\n                >\n                    '+e.map(function(e){return t.renderOptions(e,n[e])}).join("")+"\n                </select>\n            </div>\n        "}}]),i}();_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CPFText=function(e){function i(e,t){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return n.type="text",n}return _inherits(i,CPField),_createClass(i,[{key:"content",value:function(){return'\n            <div class="'+this.prefix+'-control-group" '+this.idAttribute+'="'+this.id+'">\n                '+this.label()+'\n                <input \n                    type="text"\n                    name="'+this.props.name+'"\n                    autoComplete="off"\n                    class="'+this.prefix+'-form-control"\n                    '+(this.placeholder()?'placeholder="'+this.placeholder()+'"':"")+"\n                />\n            </div>\n        "}}]),i}();_createClass=function(){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var CPFTime=function(e){function i(e,t){_classCallCheck(this,i);var n=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,t));return n.type="time",n}return _inherits(i,CPField),_createClass(i,[{key:"content",value:function(){return'\n            <div class="'+this.prefix+'-control-group" '+this.idAttribute+'="'+this.id+'">\n                '+this.label()+'\n                <input \n                    type="time"\n                    name="'+this.props.name+'"\n                    autoComplete="off"\n                    class="'+this.prefix+'-form-control"\n                    '+(this.placeholder()?'placeholder="'+this.placeholder()+'"':"")+"\n                />\n            </div>\n        "}}]),i}();